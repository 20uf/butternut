!function(){"use strict";function t(t){t=t||"";var n=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),n.appendChild(e)}function n(t,n){return(n||document).querySelector(t)}function e(t,n){return(n||document).querySelectorAll(t)}function o(t,n,e,o){t.addEventListener(n,e,!!o)}function i(t,n,i,r){function l(o){var i=o.target,l=e(n,t);Array.prototype.indexOf.call(l,i)>=0&&r.call(i,o)}o(t,i,l,"blur"===i||"focus"===i)}function r(t,n){if(t.parentNode)return t.parentNode.tagName.toLowerCase()===n.toLowerCase()?t.parentNode:r(t.parentNode,n)}function l(t){n(".filters .selected").className="",n('.filters [href="#/'+t+'"]').className="selected"}function a(t,e){var o=n('[data-id="'+t+'"]');o&&(o.className=e?"completed":"",n("input",o).checked=e)}function d(t,e){var o=n('[data-id="'+t+'"]');if(o){o.className=o.className+" editing";var i=document.createElement("input");i.className="edit",o.appendChild(i),i.focus(),i.value=e}}function s(t){var n=r(t,"li");return parseInt(n.dataset.id,10)}function p(t,n){var e=this;e.model=t,e.view=n,e.view.bind("newTodo",function(t){e.addItem(t)}),e.view.bind("itemEdit",function(t){e.editItem(t.id)}),e.view.bind("itemEditDone",function(t){e.editItemSave(t.id,t.title)}),e.view.bind("itemEditCancel",function(t){e.editItemCancel(t.id)}),e.view.bind("itemRemove",function(t){e.removeItem(t.id)}),e.view.bind("itemToggle",function(t){e.toggleComplete(t.id,t.completed)}),e.view.bind("removeCompleted",function(){e.removeCompletedItems()}),e.view.bind("toggleAll",function(t){e.toggleAll(t.completed)})}function c(t){this.storage=t}function f(t,n){if(n=n||function(){},this._dbName=t,!localStorage[t]){var e={todos:[]};localStorage[t]=JSON.stringify(e)}n.call(this,JSON.parse(localStorage[t]))}function h(){this.defaultTemplate='\n    <li data-id="{{id}}" class="{{completed}}">\n      <div class="view">\n        <input class="toggle" type="checkbox" {{checked}} />\n        <label>{{title}}</label>\n        <button class="destroy"></button>\n      </div>\n    </li>\n  '}function m(t){this.storage=new f(t),this.model=new c(this.storage),this.template=new h,this.view=new g(this.template),this.controller=new p(this.model,this.view)}function u(){y.controller.setView(document.location.hash)}t("hr {\n\tmargin: 20px 0;\n\tborder: 0;\n\tborder-top: 1px dashed #c5c5c5;\n\tborder-bottom: 1px dashed #f7f7f7;\n}\n\n.learn a {\n\tfont-weight: normal;\n\ttext-decoration: none;\n\tcolor: #b83f45;\n}\n\n.learn a:hover {\n\ttext-decoration: underline;\n\tcolor: #787e7e;\n}\n\n.learn h3,\n.learn h4,\n.learn h5 {\n\tmargin: 10px 0;\n\tfont-weight: 500;\n\tline-height: 1.2;\n\tcolor: #000;\n}\n\n.learn h3 {\n\tfont-size: 24px;\n}\n\n.learn h4 {\n\tfont-size: 18px;\n}\n\n.learn h5 {\n\tmargin-bottom: 0;\n\tfont-size: 14px;\n}\n\n.learn ul {\n\tpadding: 0;\n\tmargin: 0 0 30px 25px;\n}\n\n.learn li {\n\tline-height: 20px;\n}\n\n.learn p {\n\tfont-size: 15px;\n\tfont-weight: 300;\n\tline-height: 1.3;\n\tmargin-top: 0;\n\tmargin-bottom: 0;\n}\n\n#issue-count {\n\tdisplay: none;\n}\n\n.quote {\n\tborder: none;\n\tmargin: 20px 0 60px 0;\n}\n\n.quote p {\n\tfont-style: italic;\n}\n\n.quote p:before {\n\tcontent: '“';\n\tfont-size: 50px;\n\topacity: .15;\n\tposition: absolute;\n\ttop: -20px;\n\tleft: 3px;\n}\n\n.quote p:after {\n\tcontent: '”';\n\tfont-size: 50px;\n\topacity: .15;\n\tposition: absolute;\n\tbottom: -42px;\n\tright: 3px;\n}\n\n.quote footer {\n\tposition: absolute;\n\tbottom: -40px;\n\tright: 0;\n}\n\n.quote footer img {\n\tborder-radius: 3px;\n}\n\n.quote footer a {\n\tmargin-left: 5px;\n\tvertical-align: middle;\n}\n\n.speech-bubble {\n\tposition: relative;\n\tpadding: 10px;\n\tbackground: rgba(0, 0, 0, .04);\n\tborder-radius: 5px;\n}\n\n.speech-bubble:after {\n\tcontent: '';\n\tposition: absolute;\n\ttop: 100%;\n\tright: 30px;\n\tborder: 13px solid transparent;\n\tborder-top-color: rgba(0, 0, 0, .04);\n}\n\n.learn-bar > .learn {\n\tposition: absolute;\n\twidth: 272px;\n\ttop: 8px;\n\tleft: -300px;\n\tpadding: 10px;\n\tborder-radius: 5px;\n\tbackground-color: rgba(255, 255, 255, .6);\n\ttransition-property: left;\n\ttransition-duration: 500ms;\n}\n\n@media (min-width: 899px) {\n\t.learn-bar {\n\t\twidth: auto;\n\t\tpadding-left: 300px;\n\t}\n\n\t.learn-bar > .learn {\n\t\tleft: 8px;\n\t}\n}\n"),t('html,\nbody {\n\tmargin: 0;\n\tpadding: 0;\n}\n\nbutton {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tbackground: none;\n\tfont-size: 100%;\n\tvertical-align: baseline;\n\tfont-family: inherit;\n\tfont-weight: inherit;\n\tcolor: inherit;\n\t-webkit-appearance: none;\n\tappearance: none;\n\t-webkit-font-smoothing: antialiased;\n\t-moz-osx-font-smoothing: grayscale;\n}\n\nbody {\n\tfont: 14px \'Helvetica Neue\', Helvetica, Arial, sans-serif;\n\tline-height: 1.4em;\n\tbackground: #f5f5f5;\n\tcolor: #4d4d4d;\n\tmin-width: 230px;\n\tmax-width: 550px;\n\tmargin: 0 auto;\n\t-webkit-font-smoothing: antialiased;\n\t-moz-osx-font-smoothing: grayscale;\n\tfont-weight: 300;\n}\n\nbutton,\ninput[type="checkbox"] {\n\toutline: none;\n}\n\n.hidden {\n\tdisplay: none;\n}\n\n.todoapp {\n\tbackground: #fff;\n\tmargin: 130px 0 40px 0;\n\tposition: relative;\n\tbox-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2),\n\t            0 25px 50px 0 rgba(0, 0, 0, 0.1);\n}\n\n.todoapp input::-webkit-input-placeholder {\n\tfont-style: italic;\n\tfont-weight: 300;\n\tcolor: #e6e6e6;\n}\n\n.todoapp input::-moz-placeholder {\n\tfont-style: italic;\n\tfont-weight: 300;\n\tcolor: #e6e6e6;\n}\n\n.todoapp input::input-placeholder {\n\tfont-style: italic;\n\tfont-weight: 300;\n\tcolor: #e6e6e6;\n}\n\n.todoapp h1 {\n\tposition: absolute;\n\ttop: -155px;\n\twidth: 100%;\n\tfont-size: 100px;\n\tfont-weight: 100;\n\ttext-align: center;\n\tcolor: rgba(175, 47, 47, 0.15);\n\t-webkit-text-rendering: optimizeLegibility;\n\t-moz-text-rendering: optimizeLegibility;\n\ttext-rendering: optimizeLegibility;\n}\n\n.new-todo,\n.edit {\n\tposition: relative;\n\tmargin: 0;\n\twidth: 100%;\n\tfont-size: 24px;\n\tfont-family: inherit;\n\tfont-weight: inherit;\n\tline-height: 1.4em;\n\tborder: 0;\n\toutline: none;\n\tcolor: inherit;\n\tpadding: 6px;\n\tborder: 1px solid #999;\n\tbox-shadow: inset 0 -1px 5px 0 rgba(0, 0, 0, 0.2);\n\tbox-sizing: border-box;\n\t-webkit-font-smoothing: antialiased;\n\t-moz-osx-font-smoothing: grayscale;\n}\n\n.new-todo {\n\tpadding: 16px 16px 16px 60px;\n\tborder: none;\n\tbackground: rgba(0, 0, 0, 0.003);\n\tbox-shadow: inset 0 -2px 1px rgba(0,0,0,0.03);\n}\n\n.main {\n\tposition: relative;\n\tz-index: 2;\n\tborder-top: 1px solid #e6e6e6;\n}\n\nlabel[for=\'toggle-all\'] {\n\tdisplay: none;\n}\n\n.toggle-all {\n\tposition: absolute;\n\ttop: -55px;\n\tleft: -12px;\n\twidth: 60px;\n\theight: 34px;\n\ttext-align: center;\n\tborder: none; /* Mobile Safari */\n}\n\n.toggle-all:before {\n\tcontent: \'❯\';\n\tfont-size: 22px;\n\tcolor: #e6e6e6;\n\tpadding: 10px 27px 10px 27px;\n}\n\n.toggle-all:checked:before {\n\tcolor: #737373;\n}\n\n.todo-list {\n\tmargin: 0;\n\tpadding: 0;\n\tlist-style: none;\n}\n\n.todo-list li {\n\tposition: relative;\n\tfont-size: 24px;\n\tborder-bottom: 1px solid #ededed;\n}\n\n.todo-list li:last-child {\n\tborder-bottom: none;\n}\n\n.todo-list li.editing {\n\tborder-bottom: none;\n\tpadding: 0;\n}\n\n.todo-list li.editing .edit {\n\tdisplay: block;\n\twidth: 506px;\n\tpadding: 13px 17px 12px 17px;\n\tmargin: 0 0 0 43px;\n}\n\n.todo-list li.editing .view {\n\tdisplay: none;\n}\n\n.todo-list li .toggle {\n\ttext-align: center;\n\twidth: 40px;\n\t/* auto, since non-WebKit browsers doesn\'t support input styling */\n\theight: auto;\n\tposition: absolute;\n\ttop: 0;\n\tbottom: 0;\n\tmargin: auto 0;\n\tborder: none; /* Mobile Safari */\n\t-webkit-appearance: none;\n\tappearance: none;\n}\n\n.todo-list li .toggle:after {\n\tcontent: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-10 -18 100 135"><circle cx="50" cy="50" r="50" fill="none" stroke="#ededed" stroke-width="3"/></svg>\');\n}\n\n.todo-list li .toggle:checked:after {\n\tcontent: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-10 -18 100 135"><circle cx="50" cy="50" r="50" fill="none" stroke="#bddad5" stroke-width="3"/><path fill="#5dc2af" d="M72 25L42 71 27 56l-4 4 20 20 34-52z"/></svg>\');\n}\n\n.todo-list li label {\n\twhite-space: pre-line;\n\tword-break: break-all;\n\tpadding: 15px 60px 15px 15px;\n\tmargin-left: 45px;\n\tdisplay: block;\n\tline-height: 1.2;\n\ttransition: color 0.4s;\n}\n\n.todo-list li.completed label {\n\tcolor: #d9d9d9;\n\ttext-decoration: line-through;\n}\n\n.todo-list li .destroy {\n\tdisplay: none;\n\tposition: absolute;\n\ttop: 0;\n\tright: 10px;\n\tbottom: 0;\n\twidth: 40px;\n\theight: 40px;\n\tmargin: auto 0;\n\tfont-size: 30px;\n\tcolor: #cc9a9a;\n\tmargin-bottom: 11px;\n\ttransition: color 0.2s ease-out;\n}\n\n.todo-list li .destroy:hover {\n\tcolor: #af5b5e;\n}\n\n.todo-list li .destroy:after {\n\tcontent: \'×\';\n}\n\n.todo-list li:hover .destroy {\n\tdisplay: block;\n}\n\n.todo-list li .edit {\n\tdisplay: none;\n}\n\n.todo-list li.editing:last-child {\n\tmargin-bottom: -1px;\n}\n\n.footer {\n\tcolor: #777;\n\tpadding: 10px 15px;\n\theight: 20px;\n\ttext-align: center;\n\tborder-top: 1px solid #e6e6e6;\n}\n\n.footer:before {\n\tcontent: \'\';\n\tposition: absolute;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\theight: 50px;\n\toverflow: hidden;\n\tbox-shadow: 0 1px 1px rgba(0, 0, 0, 0.2),\n\t            0 8px 0 -3px #f6f6f6,\n\t            0 9px 1px -3px rgba(0, 0, 0, 0.2),\n\t            0 16px 0 -6px #f6f6f6,\n\t            0 17px 2px -6px rgba(0, 0, 0, 0.2);\n}\n\n.todo-count {\n\tfloat: left;\n\ttext-align: left;\n}\n\n.todo-count strong {\n\tfont-weight: 300;\n}\n\n.filters {\n\tmargin: 0;\n\tpadding: 0;\n\tlist-style: none;\n\tposition: absolute;\n\tright: 0;\n\tleft: 0;\n}\n\n.filters li {\n\tdisplay: inline;\n}\n\n.filters li a {\n\tcolor: inherit;\n\tmargin: 3px;\n\tpadding: 3px 7px;\n\ttext-decoration: none;\n\tborder: 1px solid transparent;\n\tborder-radius: 3px;\n}\n\n.filters li a.selected,\n.filters li a:hover {\n\tborder-color: rgba(175, 47, 47, 0.1);\n}\n\n.filters li a.selected {\n\tborder-color: rgba(175, 47, 47, 0.2);\n}\n\n.clear-completed,\nhtml .clear-completed:active {\n\tfloat: right;\n\tposition: relative;\n\tline-height: 20px;\n\ttext-decoration: none;\n\tcursor: pointer;\n}\n\n.clear-completed:hover {\n\ttext-decoration: underline;\n}\n\n.info {\n\tmargin: 65px auto 0;\n\tcolor: #bfbfbf;\n\tfont-size: 10px;\n\ttext-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);\n\ttext-align: center;\n}\n\n.info p {\n\tline-height: 1;\n}\n\n.info a {\n\tcolor: inherit;\n\ttext-decoration: none;\n\tfont-weight: 400;\n}\n\n.info a:hover {\n\ttext-decoration: underline;\n}\n\n/*\n\tHack to remove background from Mobile Safari.\n\tCan\'t use it globally since it destroys checkboxes in Firefox\n*/\n@media screen and (-webkit-min-device-pixel-ratio:0) {\n\t.toggle-all,\n\t.todo-list li .toggle {\n\t\tbackground: none;\n\t}\n\n\t.todo-list li .toggle {\n\t\theight: 40px;\n\t}\n\n\t.toggle-all {\n\t\t-webkit-transform: rotate(90deg);\n\t\ttransform: rotate(90deg);\n\t\t-webkit-appearance: none;\n\t\tappearance: none;\n\t}\n}\n\n@media (max-width: 430px) {\n\t.footer {\n\t\theight: 50px;\n\t}\n\n\t.filters {\n\t\tbottom: 10px;\n\t}\n}\n'),NodeList.prototype.forEach=Array.prototype.forEach;var g=function(t){this.template=t,this.ENTER_KEY=13,this.ESCAPE_KEY=27,this.$todoList=n(".todo-list"),this.$todoItemCounter=n(".todo-count"),this.$clearCompleted=n(".clear-completed"),this.$main=n(".main"),this.$footer=n(".footer"),this.$toggleAll=n(".toggle-all"),this.$newTodo=n(".new-todo")};g.prototype._removeItem=function(t){var e=n('[data-id="'+t+'"]');e&&this.$todoList.removeChild(e)},g.prototype._clearCompletedButton=function(t,n){this.$clearCompleted.innerHTML=this.template.clearCompletedButton(t),this.$clearCompleted.style.display=n?"block":"none"},g.prototype._editItemDone=function(t,o){var i=n('[data-id="'+t+'"]');if(i){var r=n("input.edit",i);i.removeChild(r),i.className=i.className.replace("editing",""),e("label",i).forEach(function(t){t.textContent=o})}},g.prototype.render=function(t,n){var e=this;({showEntries:function(){e.$todoList.innerHTML=e.template.show(n)},removeItem:function(){e._removeItem(n)},updateElementCount:function(){e.$todoItemCounter.innerHTML=e.template.itemCounter(n)},clearCompletedButton:function(){e._clearCompletedButton(n.completed,n.visible)},contentBlockVisibility:function(){e.$main.style.display=e.$footer.style.display=n.visible?"block":"none"},toggleAll:function(){e.$toggleAll.checked=n.checked},setFilter:function(){l(n)},clearNewTodo:function(){e.$newTodo.value=""},elementComplete:function(){a(n.id,n.completed)},editItem:function(){d(n.id,n.title)},editItemDone:function(){e._editItemDone(n.id,n.title)}})[t]()},g.prototype._bindItemEditDone=function(t){var n=this;i(n.$todoList,"li .edit","blur",function(){this.dataset.iscanceled||t({id:s(this),title:this.value})}),i(n.$todoList,"li .edit","keypress",function(t){t.keyCode===n.ENTER_KEY&&this.blur()})},g.prototype._bindItemEditCancel=function(t){var n=this;i(n.$todoList,"li .edit","keyup",function(e){e.keyCode===n.ESCAPE_KEY&&(this.dataset.iscanceled=!0,this.blur(),t({id:s(this)}))})},g.prototype.bind=function(t,n){var e=this;"newTodo"===t?o(e.$newTodo,"change",function(){n(e.$newTodo.value)}):"removeCompleted"===t?o(e.$clearCompleted,"click",function(){n()}):"toggleAll"===t?o(e.$toggleAll,"click",function(){n({completed:this.checked})}):"itemEdit"===t?i(e.$todoList,"li label","dblclick",function(){n({id:s(this)})}):"itemRemove"===t?i(e.$todoList,".destroy","click",function(){n({id:s(this)})}):"itemToggle"===t?i(e.$todoList,".toggle","click",function(){n({id:s(this),completed:this.checked})}):"itemEditDone"===t?e._bindItemEditDone(n):"itemEditCancel"===t&&e._bindItemEditCancel(n)},p.prototype.setView=function(t){var n=t.split("/")[1],e=n||"";this._updateFilterState(e)},p.prototype.showAll=function(){var t=this;t.model.read(function(n){t.view.render("showEntries",n)})},p.prototype.showActive=function(){var t=this;t.model.read({completed:!1},function(n){t.view.render("showEntries",n)})},p.prototype.showCompleted=function(){var t=this;t.model.read({completed:!0},function(n){t.view.render("showEntries",n)})},p.prototype.addItem=function(t){var n=this;""!==t.trim()&&n.model.create(t,function(){n.view.render("clearNewTodo"),n._filter(!0)})},p.prototype.editItem=function(t){var n=this;n.model.read(t,function(e){n.view.render("editItem",{id:t,title:e[0].title})})},p.prototype.editItemSave=function(t,n){var e=this;n.trim()?e.model.update(t,{title:n},function(){e.view.render("editItemDone",{id:t,title:n})}):e.removeItem(t)},p.prototype.editItemCancel=function(t){var n=this;n.model.read(t,function(e){n.view.render("editItemDone",{id:t,title:e[0].title})})},p.prototype.removeItem=function(t){var n=this;n.model.remove(t,function(){n.view.render("removeItem",t)}),n._filter()},p.prototype.removeCompletedItems=function(){var t=this;t.model.read({completed:!0},function(n){n.forEach(function(n){t.removeItem(n.id)})}),t._filter()},p.prototype.toggleComplete=function(t,n,e){var o=this;o.model.update(t,{completed:n},function(){o.view.render("elementComplete",{id:t,completed:n})}),e||o._filter()},p.prototype.toggleAll=function(t){var n=this;n.model.read({completed:!t},function(e){e.forEach(function(e){n.toggleComplete(e.id,t,!0)})}),n._filter()},p.prototype._updateCount=function(){var t=this;t.model.getCount(function(n){t.view.render("updateElementCount",n.active),t.view.render("clearCompletedButton",{completed:n.completed,visible:n.completed>0}),t.view.render("toggleAll",{checked:n.completed===n.total}),t.view.render("contentBlockVisibility",{visible:n.total>0})})},p.prototype._filter=function(t){var n=this._activeRoute.charAt(0).toUpperCase()+this._activeRoute.substr(1);this._updateCount(),(t||"All"!==this._lastActiveRoute||this._lastActiveRoute!==n)&&this["show"+n](),this._lastActiveRoute=n},p.prototype._updateFilterState=function(t){this._activeRoute=t,""===t&&(this._activeRoute="All"),this._filter(),this.view.render("setFilter",t)},c.prototype.create=function(t,n){t=t||"",n=n||function(){};var e={title:t.trim(),completed:!1};this.storage.save(e,n)},c.prototype.read=function(t,n){var e=typeof t;if(n=n||function(){},"function"===e)return n=t,this.storage.findAll(n);"string"===e||"number"===e?(t=parseInt(t,10),this.storage.find({id:t},n)):this.storage.find(t,n)},c.prototype.update=function(t,n,e){this.storage.save(n,e,t)},c.prototype.remove=function(t,n){this.storage.remove(t,n)},c.prototype.removeAll=function(t){this.storage.drop(t)},c.prototype.getCount=function(t){var n={active:0,completed:0,total:0};this.storage.findAll(function(e){e.forEach(function(t){t.completed?n.completed++:n.active++,n.total++}),t(n)})},f.prototype.find=function(t,n){if(n){var e=JSON.parse(localStorage[this._dbName]).todos;n.call(this,e.filter(function(n){for(var e in t)if(t[e]!==n[e])return!1;return!0}))}},f.prototype.findAll=function(t){t=t||function(){},t.call(this,JSON.parse(localStorage[this._dbName]).todos)},f.prototype.save=function(t,n,e){var o=JSON.parse(localStorage[this._dbName]),i=o.todos;if(n=n||function(){},e){for(var r=0;r<i.length;r++)if(i[r].id===e){for(var l in t)i[r][l]=t[l];break}localStorage[this._dbName]=JSON.stringify(o),n.call(this,JSON.parse(localStorage[this._dbName]).todos)}else t.id=(new Date).getTime(),i.push(t),localStorage[this._dbName]=JSON.stringify(o),n.call(this,[t])},f.prototype.remove=function(t,n){for(var e=JSON.parse(localStorage[this._dbName]),o=e.todos,i=0;i<o.length;i++)if(o[i].id===t){o.splice(i,1);break}localStorage[this._dbName]=JSON.stringify(e),n.call(this,JSON.parse(localStorage[this._dbName]).todos)},f.prototype.drop=function(t){localStorage[this._dbName]=JSON.stringify({todos:[]}),t.call(this,JSON.parse(localStorage[this._dbName]).todos)};var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},x=function(t){return b[t]},v=new RegExp(/[&<>"'`]/g.source),w=function(t){return t&&v.test(t)?t.replace(/[&<>"'`]/g,x):t};h.prototype.show=function(t){var n,e,o="";for(n=0,e=t.length;n<e;n++){var i=this.defaultTemplate,r="",l="";t[n].completed&&(r="completed",l="checked"),i=i.replace("{{id}}",t[n].id),i=i.replace("{{title}}",w(t[n].title)),i=i.replace("{{completed}}",r),i=i.replace("{{checked}}",l),o+=i}return o},h.prototype.itemCounter=function(t){return"<strong>"+t+"</strong> item"+(1===t?"":"s")+" left"},h.prototype.clearCompletedButton=function(t){return t>0?"Clear completed":""};var y;o(window,"load",function(){y=new m("todos-vanillajs"),u()}),o(window,"hashchange",u)}();